<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:controls="clr-namespace:Avalonia.Controls;assembly=Avalonia.Controls.DataGrid"
             x:Class="BankSystem.UI.Views.LoansView">
  <ScrollViewer HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
    <StackPanel Spacing="0" Background="#F5F7FA">
      
      <!-- Header con fondo azul -->
      <Border Background="#002855" Padding="24,24,24,32" CornerRadius="0,0,24,24">
        <StackPanel Spacing="16">
          <StackPanel Spacing="8">
            <TextBlock Text="ðŸ¦ PRÃ‰STAMOS" 
                       FontSize="13" 
                       FontWeight="Bold" 
                       Foreground="#FF6600"
                       LetterSpacing="1"/>
            <TextBlock Text="Solicita y gestiona tus prÃ©stamos" 
                       FontSize="16" 
                       FontWeight="SemiBold" 
                       Foreground="White"/>
          </StackPanel>
        </StackPanel>
      </Border>

      <StackPanel Spacing="16" Margin="24,-20,24,24">
        
        <!-- Formulario de nuevo prÃ©stamo -->
        <Border Background="White" 
                CornerRadius="16" 
                Padding="24"
                BoxShadow="0 2 12 0 #11000000">
          <StackPanel Spacing="20">
            <StackPanel Orientation="Horizontal" Spacing="12">
              <Border Background="#FFE5CC" CornerRadius="8" Width="40" Height="40" Padding="8">
                <TextBlock Text="âž•" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center"/>
              </Border>
              <StackPanel VerticalAlignment="Center">
                <TextBlock Text="Nuevo PrÃ©stamo" FontSize="18" FontWeight="Bold" Foreground="#1E293B"/>
                <TextBlock Text="Completa los datos para solicitar" FontSize="12" Foreground="#64748B"/>
              </StackPanel>
            </StackPanel>

            <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto,Auto,Auto" ColumnSpacing="16" RowSpacing="16">
              
              <!-- Cliente ID -->
              <StackPanel Grid.Column="0" Grid.Row="0" Spacing="8">
                <TextBlock Text="ðŸ‘¤ ID del Cliente" FontWeight="SemiBold" FontSize="13" Foreground="#64748B"/>
                <NumericUpDown Minimum="1" 
                               Maximum="999999" 
                               Value="{Binding CustomerId}"
                               Height="40"
                               CornerRadius="8"
                               FontSize="14"/>
              </StackPanel>

              <!-- Tipo de prÃ©stamo -->
              <StackPanel Grid.Column="1" Grid.Row="0" Spacing="8">
                <TextBlock Text="ðŸ“‹ Tipo de PrÃ©stamo" FontWeight="SemiBold" FontSize="13" Foreground="#64748B"/>
                <ComboBox SelectedValue="{Binding LoanType}" 
                          SelectedValueBinding="{Binding Tag}"
                          Height="40"
                          CornerRadius="8"
                          FontSize="14"
                          HorizontalAlignment="Stretch">
                  <ComboBoxItem Content="ðŸ’¼ Personal" Tag="1"/>
                  <ComboBoxItem Content="ðŸ  Hipotecario" Tag="2"/>
                  <ComboBoxItem Content="ðŸš— Auto" Tag="3"/>
                </ComboBox>
              </StackPanel>

              <!-- Monto Principal -->
              <StackPanel Grid.Column="0" Grid.Row="1" Spacing="8">
                <TextBlock Text="ðŸ’° Monto Principal" FontWeight="SemiBold" FontSize="13" Foreground="#64748B"/>
                <NumericUpDown Minimum="0" 
                               Maximum="10000000" 
                               Value="{Binding Principal}"
                               Height="40"
                               CornerRadius="8"
                               FontSize="14"
                               FormatString="C2"/>
              </StackPanel>

              <!-- Plazo en meses -->
              <StackPanel Grid.Column="1" Grid.Row="1" Spacing="8">
                <TextBlock Text="ðŸ“… Plazo (Meses)" FontWeight="SemiBold" FontSize="13" Foreground="#64748B"/>
                <NumericUpDown Minimum="1" 
                               Maximum="360" 
                               Value="{Binding Months}"
                               Height="40"
                               CornerRadius="8"
                               FontSize="14"/>
              </StackPanel>

              <!-- Moneda -->
              <StackPanel Grid.Column="0" Grid.Row="2" Spacing="8">
                <TextBlock Text="ðŸ’± Moneda" FontWeight="SemiBold" FontSize="13" Foreground="#64748B"/>
                <ComboBox SelectedValue="{Binding Currency}" 
                          SelectedValueBinding="{Binding Tag}"
                          Height="40"
                          CornerRadius="8"
                          FontSize="14"
                          HorizontalAlignment="Stretch">
                  <ComboBoxItem Content="ðŸ‡ºðŸ‡¸ USD - DÃ³lar" Tag="USD"/>
                  <ComboBoxItem Content="ðŸ‡ªðŸ‡º EUR - Euro" Tag="EUR"/>
                  <ComboBoxItem Content="ðŸ‡¯ðŸ‡µ JPY - Yen" Tag="JPY"/>
                  <ComboBoxItem Content="ðŸ‡°ðŸ‡· KRW - Won" Tag="KRW"/>
                  <ComboBoxItem Content="ðŸ‡§ðŸ‡´ BOB - Boliviano" Tag="BOB"/>
                  <ComboBoxItem Content="ðŸ‡¬ðŸ‡§ GBP - Libra" Tag="GBP"/>
                </ComboBox>
              </StackPanel>

              <!-- Cuota mensual estimada -->
              <Border Grid.Column="1" Grid.Row="2" 
                      Background="#FEF3C7" 
                      CornerRadius="8" 
                      Padding="12"
                      VerticalAlignment="Bottom">
                <StackPanel Spacing="4">
                  <TextBlock Text="ðŸ’¡ Cuota mensual estimada" FontSize="11" Foreground="#92400E" FontWeight="SemiBold"/>
                  <TextBlock Text="{Binding Installment, StringFormat='{}{0:C2}'}" 
                             FontSize="18" 
                             FontWeight="Bold" 
                             Foreground="#78350F"/>
                </StackPanel>
              </Border>

              <!-- BotÃ³n de crear -->
              <Button Grid.Column="0" Grid.ColumnSpan="2" Grid.Row="3"
                      Content="âœ… Solicitar PrÃ©stamo" 
                      Command="{Binding CreateLoanCommand}"
                      Height="48"
                      CornerRadius="10"
                      Background="#FF6600"
                      Foreground="White"
                      FontSize="15"
                      FontWeight="Bold"
                      BorderThickness="0"
                      HorizontalAlignment="Stretch">
                <Button.Styles>
                  <Style Selector="Button:pointerover">
                    <Setter Property="Background" Value="#FF7722"/>
                  </Style>
                </Button.Styles>
              </Button>
            </Grid>
          </StackPanel>
        </Border>

        <!-- Mis prÃ©stamos -->
        <Border Background="White" 
                CornerRadius="16" 
                Padding="24"
                BoxShadow="0 2 12 0 #11000000">
          <StackPanel Spacing="16">
            <StackPanel Orientation="Horizontal" Spacing="12">
              <Border Background="#E0E7FF" CornerRadius="8" Width="40" Height="40" Padding="8">
                <TextBlock Text="ðŸ“Š" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center"/>
              </Border>
              <StackPanel VerticalAlignment="Center" Spacing="4">
                <TextBlock Text="Mis PrÃ©stamos Activos" FontSize="18" FontWeight="Bold" Foreground="#1E293B"/>
                <TextBlock Text="ðŸ“Œ Haz clic en un prÃ©stamo para ver su tabla de amortizaciÃ³n abajo" 
                           FontSize="12" 
                           Foreground="#FF6600"
                           FontWeight="SemiBold"/>
              </StackPanel>
            </StackPanel>

            <Border BorderBrush="#E2E8F0" 
                    BorderThickness="1" 
                    CornerRadius="8"
                    Background="#F8FAFC"
                    MinHeight="200">
              <StackPanel>
                <controls:DataGrid ItemsSource="{Binding Loans}" 
                                   AutoGenerateColumns="True" 
                                   SelectedItem="{Binding SelectedLoan}"
                                   MinHeight="180"
                                   Background="Transparent"
                                   BorderThickness="0"
                                   GridLinesVisibility="Horizontal"/>
              </StackPanel>
            </Border>
          </StackPanel>
        </Border>

        <!-- Tabla de amortizaciÃ³n (se muestra cuando seleccionas un prÃ©stamo) -->
        <Border Background="White" 
                CornerRadius="16" 
                Padding="24"
                BoxShadow="0 2 12 0 #11000000"
                IsVisible="{Binding SelectedLoan, Converter={x:Static ObjectConverters.IsNotNull}}">
          <StackPanel Spacing="16">
            <StackPanel Orientation="Horizontal" Spacing="12">
              <Border Background="#DBEAFE" CornerRadius="8" Width="40" Height="40" Padding="8">
                <TextBlock Text="ðŸ“ˆ" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center"/>
              </Border>
              <StackPanel VerticalAlignment="Center" Spacing="4">
                <TextBlock Text="Tabla de AmortizaciÃ³n del PrÃ©stamo Seleccionado" 
                           FontSize="18" 
                           FontWeight="Bold" 
                           Foreground="#1E293B"/>
                <StackPanel Orientation="Horizontal" Spacing="8">
                  <TextBlock Text="ðŸ’° Cuota mensual:" FontSize="12" Foreground="#64748B"/>
                  <TextBlock Text="{Binding Installment, StringFormat='{}{0:C2}'}" 
                             FontSize="13" 
                             FontWeight="Bold" 
                             Foreground="#FF6600"/>
                </StackPanel>
              </StackPanel>
            </StackPanel>

            <Border BorderBrush="#E2E8F0" 
                    BorderThickness="1" 
                    CornerRadius="8"
                    Background="#F8FAFC">
              <controls:DataGrid ItemsSource="{Binding Amortization}" 
                                 AutoGenerateColumns="True" 
                                 Height="300"
                                 Background="Transparent"
                                 BorderThickness="0"
                                 GridLinesVisibility="Horizontal"/>
            </Border>
          </StackPanel>
        </Border>

      </StackPanel>
    </StackPanel>
  </ScrollViewer>
</UserControl>
